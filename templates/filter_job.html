{%extends 'base.html' %}
{%load static%}
{%block links%}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha1/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
<link rel="stylesheet" href="{%static 'css/filter1.css' %}">
{%endblock links%}
{%block title%}
Jobs
{%endblock title%}
{%block contents%}
<style>
  .long-img {
    height: 100%;
    object-fit: cover;
  }
</style>
<div class="container my-sm-5 border p-0 bg-sec-light">
  {%csrf_token%}
  <div id="content">
    <div class="bg-light p-2 px-md-4 px-3 shadow-sm mb-2">
      <button class="btn btn-dark hBack" type="button">Go Back</button>
    </div>
  </div>
  <div class="d-sm-flex">
    <div class="me-sm-2">
      <div id="filter" class="p-2 bg-light ms-md-4 ms-sm-2 border">
        <div class="border-bottom h5 text-uppercase">Filter By</div>
        <div class="box border-bottom">
          <div class="box-label text-uppercase d-flex align-items-center">
            Pay
            <button class="btn ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#inner-box"
              aria-expanded="false" aria-controls="inner-box">
              <span class="fas fa-plus"></span>
            </button>
          </div>
          <div class="">
            <!-- <label for="validationCustom05" class="form-label">Country of Citizenship?</label> -->
            <select class="form-select" id="pay" required="">
              <option selected="" disabled="" value="">Choose...</option>
              <option value="Hourly">Hourly</option>
              <option value="Commission">Commission</option>
              <option value="Hourly with Commission">Hourly with Commission</option>
            </select>

            <div class="invalid-feedback">
              Please select a valid Country.
            </div>
          </div>
        </div>
        <!---Ends And Starts-->
        <div class="box border-bottom">
          <div class="box-label text-uppercase d-flex align-items-center">
            Role
          </div>
          <div class="">
            <!-- <label for="validationCustom05" class="form-label">Country of Citizenship?</label> -->
            <select class="form-select" id="category" required="">
              <option selected="" disabled="" value="">Choose...</option>
              <option value="closers">Closers</option>
              <option value="appointment setters">Appointment setters</option>
              <option value="Closer & Appointment setter">Both</option>
            </select>

            <div class="invalid-feedback">
              Please select a valid Country.
            </div>
          </div>
        </div>
        <!-- Langs -->
        <div class="box border-bottom">
          <div class="box-label text-uppercase d-flex align-items-center">
            Language
          </div>
          <div class="">
            <select class="form-select" id="id_language" required="">
              <option selected="" disabled="" value="">Choose...</option>
              {%for obj in obj%}
              <option value="{{obj.name}}">{{obj.name}}</option>
              {%endfor%}
            </select>
            <div class="invalid-feedback">
              Please select a valid Country.
            </div>
          </div>
        </div>
        <!--Ends And Starts-->
        <div class="box border-bottom">
          <div class="box-label text-uppercase d-flex align-items-center">
            Country
          </div>
          <div class="">
            <label for="validationCustom05" class="form-label">Country</label>
            {{form.country}}
            <div class="invalid-feedback">
              Please select a valid Country.
            </div>
          </div>
        </div>
        <div class="box border-bottom">
          <div class="m-auto px-5">
              <button class="btn btn-success" type="button" id="filter-btn" >Apply</button>
          </div>
        </div>




      </div>
    </div>
    <div class="container mt-3 mb-3">
      {%for qs in qs%}
      <div class="card mb-3 rounded shadow-sm">
        <div class="row">
          <div class="col-md-3">
            <svg style="margin: 20px;" fill="#4E73DF" height="200px" width="200px" version="1.1" id="Capa_1"
              xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 490 490"
              xml:space="preserve">
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g id="SVGRepo_iconCarrier">
                <g>
                  <g>
                    <ellipse cx="245" cy="45.5" rx="46.3" ry="45.5"></ellipse>
                    <path d="M431.7,182.4L304.5,75.8c-3.1,6.2-7.4,11.7-12.4,16.7l107.3,89.8h32.3V182.4z"></path>
                    <path d="M197.9,92.6c-5.1-5.1-9.3-10.5-12.4-16.7L58.3,182.4H91L197.9,92.6z"></path>
                    <g>
                      <ellipse cx="225.6" cy="292.7" rx="9.5" ry="23.5"></ellipse>
                      <path d="M200.9,376.9h-9.4v17.6h9.4c5.4,0,9.8-3.9,9.8-8.8S206.3,376.9,200.9,376.9z"></path>
                      <path
                        d="M0,203v287h490V203H0z M130.8,429.7c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9v-23.5h-17.6v23.5c0,3.2-2.9,5.9-6.5,5.9 s-6.5-2.6-6.5-5.9V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9v23.5h17.6V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9V429.7z M160.8,429.7c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9V429.7z M175.4,325l-26.9-40.5 V322c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9v-58.6c0-2.6,2-5,4.8-5.7s5.8,0.4,7.3,2.6l26.9,40.5v-37.4c0-3.2,2.9-5.9,6.5-5.9 s6.5,2.6,6.5,5.9V322c0,2.6-2,4.8-4.8,5.7C181.2,328.1,177.6,328.2,175.4,325z M223,426.3c1.6,2.9,0.2,6.5-2.9,7.9 c-2,0.9-5.9,1.6-8.8-2.6L197,406.2h-5.6v23.5c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9V371c0-3.2,2.9-5.9,6.5-5.9h15.9 c12.6,0,22.8,9.2,22.8,20.5c0,8.2-5.4,15.3-13.1,18.6L223,426.3z M225.6,327.9c-12.4,0-22.5-15.8-22.5-35.2 c0-19.4,10.1-35.2,22.5-35.2s22.5,15.8,22.5,35.2S238,327.9,225.6,327.9z M253.6,429.7c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9 V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9V429.7z M323.8,429.7c0,2.6-2,5-4.8,5.7c-0.6,0.1-4.6,1-7.3-2.6l-26.9-40.5v37.4 c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9V371c0-2.6,2-5,4.8-5.7s5.8,0.4,7.3,2.6l26.9,40.5V371c0-3.2,2.9-5.9,6.5-5.9 s6.5,2.6,6.5,5.9V429.7z M338.4,264.8L321,323.4c-0.8,2.6-3.3,4.4-6.3,4.4s-5.5-1.8-6.3-4.4L297.2,286l-11.1,37.4 c-0.8,2.6-3.3,4.4-6.3,4.4s-5.5-1.8-6.3-4.4l-17.4-58.6c-0.9-3.1,1.1-6.3,4.6-7.2c3.5-0.8,7,1,8,4.2l11.1,37.4l9.9-36.2 c0.9-3.3,3.9-5.6,7.3-5.6s6.4,2.3,7.3,5.5l10.3,36.3l11.1-37.4c0.9-3.1,4.5-5,8-4.2C337.2,258.5,339.3,261.7,338.4,264.8z M371.3,435.6c-15,0-31.6-13.7-31.6-35.2c0-11.8,8.6-35.2,31.6-35.2c9.3,0,18,4.4,24,12.2c2.1,2.7,1.3,6.3-1.6,8.2 s-7,1.2-9.1-1.5c-3.6-4.6-8.3-7.2-13.3-7.2c-12.8,0-18.6,14.7-18.6,23.5c0,11.4,7.2,23.5,18.6,23.5c12.1,0,18-13.3,18-17.6h-18 c-3.6,0-6.5-2.6-6.5-5.9c0-3.2,2.9-5.9,6.5-5.9h25.1c3.6,0,6.5,2.6,6.5,5.9C402.9,414,393.6,435.6,371.3,435.6z">
                      </path>
                    </g>
                  </g>
                </g>
              </g>
            </svg>

          </div>
          <div class="col-md-6 px-5">
            <h2 class="card-title mt-3">{{qs.job_title}}</h2>
            <p>{{qs.job_description|safe}}</p>
            <!-- <form action="" method="POST" id="apply_form"></form> -->
              <button class="btn btn-success mb-3" id="apply-{{qs.pk}}" data-job="{{qs.job_title}}" type="button" onclick="applyNow(`apply-{{qs.pk}}`)">Apply</button>
            <!-- </form> -->
          </div>
          <div class="col-md-3 justify-content-center pt-4 " style="display: grid;  ">


            <div class="row">
              <p class="text-muted fs-6 text-wrap d-flex" style="font-size: initial;"><i
                  class="fa fa-user fa-1x"></i>{{qs.category}}</p>
            </div>
          </div>
        </div>
      </div>
      {%endfor%}
    </div>



  </div>

</div>
{%endblock contents%}
{%block scripts%}
<script>
  // Previous page functionality
  $(".hBack").on("click", function(e){
    e.preventDefault();
    window.history.back();
  });
  // End
  var selectFields = document.getElementById('id_country')
  selectFields.className += 'form-select'
  //
  function applyNow(Id){
    $(`#${Id}`).on('click', ()=>{
      $.ajax({
        url:'/apply/',
        type:'POST',
        data:{
          job: $(this).attr('data-job'),
          link: '/userprofile/{{request.user.first_name}}-{{request.user.last_name}}/',
          csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
        },
        success: function(data){
          alert(data)
        },
        error: ()=>{
          alert('unsuccessfull')
        }
      })
    })
  }
  // To filter the jobs

  $('#filter-btn').on('click', () => {
    $.ajax({
      type: 'POST',
      url: '/filter_jobs/',
      data: {
        pay: $("#pay").val(),
        category: $('#category').val(),
        language: $('#id_language').val(),
        country: $('#id_country').val(),
        csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
      },
      success: (response) => {
        $('#user-info').addClass('d-none');
        $('#filter-info').removeClass('d-none');
        $('#filter-info').empty();
        for (var result in response.results) {
          $('#filter-info').append(
            `
              <div class="card mb-3 rounded shadow-sm">
        <div class="row">
          <div class="col-md-3">
          <svg style="margin: 20px;" fill="#4E73DF" height="200px" width="200px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 490 490" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_iconCarrier"> <g> <g> <ellipse cx="245" cy="45.5" rx="46.3" ry="45.5"></ellipse> <path d="M431.7,182.4L304.5,75.8c-3.1,6.2-7.4,11.7-12.4,16.7l107.3,89.8h32.3V182.4z"></path> <path d="M197.9,92.6c-5.1-5.1-9.3-10.5-12.4-16.7L58.3,182.4H91L197.9,92.6z"></path> <g> <ellipse cx="225.6" cy="292.7" rx="9.5" ry="23.5"></ellipse> <path d="M200.9,376.9h-9.4v17.6h9.4c5.4,0,9.8-3.9,9.8-8.8S206.3,376.9,200.9,376.9z"></path> <path d="M0,203v287h490V203H0z M130.8,429.7c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9v-23.5h-17.6v23.5c0,3.2-2.9,5.9-6.5,5.9 s-6.5-2.6-6.5-5.9V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9v23.5h17.6V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9V429.7z M160.8,429.7c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9V429.7z M175.4,325l-26.9-40.5 V322c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9v-58.6c0-2.6,2-5,4.8-5.7s5.8,0.4,7.3,2.6l26.9,40.5v-37.4c0-3.2,2.9-5.9,6.5-5.9 s6.5,2.6,6.5,5.9V322c0,2.6-2,4.8-4.8,5.7C181.2,328.1,177.6,328.2,175.4,325z M223,426.3c1.6,2.9,0.2,6.5-2.9,7.9 c-2,0.9-5.9,1.6-8.8-2.6L197,406.2h-5.6v23.5c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9V371c0-3.2,2.9-5.9,6.5-5.9h15.9 c12.6,0,22.8,9.2,22.8,20.5c0,8.2-5.4,15.3-13.1,18.6L223,426.3z M225.6,327.9c-12.4,0-22.5-15.8-22.5-35.2 c0-19.4,10.1-35.2,22.5-35.2s22.5,15.8,22.5,35.2S238,327.9,225.6,327.9z M253.6,429.7c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9 V371c0-3.2,2.9-5.9,6.5-5.9s6.5,2.6,6.5,5.9V429.7z M323.8,429.7c0,2.6-2,5-4.8,5.7c-0.6,0.1-4.6,1-7.3-2.6l-26.9-40.5v37.4 c0,3.2-2.9,5.9-6.5,5.9s-6.5-2.6-6.5-5.9V371c0-2.6,2-5,4.8-5.7s5.8,0.4,7.3,2.6l26.9,40.5V371c0-3.2,2.9-5.9,6.5-5.9 s6.5,2.6,6.5,5.9V429.7z M338.4,264.8L321,323.4c-0.8,2.6-3.3,4.4-6.3,4.4s-5.5-1.8-6.3-4.4L297.2,286l-11.1,37.4 c-0.8,2.6-3.3,4.4-6.3,4.4s-5.5-1.8-6.3-4.4l-17.4-58.6c-0.9-3.1,1.1-6.3,4.6-7.2c3.5-0.8,7,1,8,4.2l11.1,37.4l9.9-36.2 c0.9-3.3,3.9-5.6,7.3-5.6s6.4,2.3,7.3,5.5l10.3,36.3l11.1-37.4c0.9-3.1,4.5-5,8-4.2C337.2,258.5,339.3,261.7,338.4,264.8z M371.3,435.6c-15,0-31.6-13.7-31.6-35.2c0-11.8,8.6-35.2,31.6-35.2c9.3,0,18,4.4,24,12.2c2.1,2.7,1.3,6.3-1.6,8.2 s-7,1.2-9.1-1.5c-3.6-4.6-8.3-7.2-13.3-7.2c-12.8,0-18.6,14.7-18.6,23.5c0,11.4,7.2,23.5,18.6,23.5c12.1,0,18-13.3,18-17.6h-18 c-3.6,0-6.5-2.6-6.5-5.9c0-3.2,2.9-5.9,6.5-5.9h25.1c3.6,0,6.5,2.6,6.5,5.9C402.9,414,393.6,435.6,371.3,435.6z"></path> </g> </g> </g> </g></svg>

          </div>
          <div class="col-md-6 px-5">
            <h2 class="card-title mt-3">{{qs.job_title}}</h2>
            <p>{{qs.job_description}}</p>
          <button class="btn btn-success mb-3">Apply</button>
          </div>
          <div class="col-md-3 justify-content-center pt-4 " style="display: grid;  ">
            <div class="row">
            <p class="text-muted fs-6 text-wrap d-flex" style="font-size: initial;"><i class="fa fa-coins fa-1x"></i>${{ qs.expected_hourly_pay }} </p>
          </div>
          <div class="row">
            <p class="text-muted fs-6 text-wrap d-flex" style="font-size: initial;"><i class="fa fa-history fa-1x"></i>3-Experience </p>
            </div>
            <div class="row">
              <p class="text-muted fs-6 text-wrap d-flex" style="font-size: initial;"><i class="fa fa-user fa-1x"></i>{{qs.category}}</p>
            </div>
          </div>
        </div>
      </div>
              `
          )
        }
      },
      error: () => {
        console.log('error getting a response back')
      }
    })
  })
</script>
{%endblock scripts%}